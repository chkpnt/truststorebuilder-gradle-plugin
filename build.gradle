apply plugin: 'groovy'
apply plugin: 'java'

group = 'de.chkpnt'
version = '1.0.0'

repositories {
	jcenter()
}

compileGroovy {
	groovyOptions.encoding = 'UTF-8'
}

sourceCompatibility = 1.8
targetCompatibility = 1.8

// Write the plugin's classpath to a file to share with the tests
task createClasspathManifest {
	def outputDir = file("$buildDir/$name")

	inputs.files sourceSets.main.runtimeClasspath
	outputs.dir outputDir

	doLast {
		outputDir.mkdirs()
		file("$outputDir/plugin-classpath.txt").text = sourceSets.main.runtimeClasspath.join("\n")
	}
}

dependencies {
	compile gradleApi()
	compile localGroovy()
	
	testCompile gradleTestKit()
	testRuntime files(createClasspathManifest)
	testCompile 'com.google.jimfs:jimfs:1.0'      // In-Memory Filesystem
	testCompile 'org.spockframework:spock-core:1.0-groovy-2.4', {
		exclude group: 'org.codehaus.groovy' }
	testCompile 'cglib:cglib-nodep:3.2.0'
	testCompile 'org.hamcrest:hamcrest-all:1.3'
}

task wrapper(type: Wrapper) {
	gradleVersion = '2.12'
	distributionUrl = 'https://services.gradle.org/distributions/gradle-2.12-all.zip'
}

apply from: 'gradle/publish.gradle'
apply from: 'gradle/jacoco.gradle'
